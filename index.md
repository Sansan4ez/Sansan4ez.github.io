# Лучшие практики создания промптов для OpenAI API

Перевод с дополнениями статьи от OpenAI.
Источник [здесь](https://help.openai.com/en/articles/6654000-best-practices-for-prompt-engineering-with-the-openai-api)

## Содержание
1. [Как работает создание промптов](#как-работает-создание-промптов)
2. [Правила и примеры](#правила-и-примеры)
   1. [Используйте последнюю модель](#1-используйте-последнюю-модель)
   2. [Поместите инструкции в начале промпта](#2-поместите-инструкции-в-начале-промпта)
   3. [Будьте конкретны](#3-будьте-конкретны)
   4. [Определите желаемый формат вывода через примеры](#4-определите-желаемый-формат-вывода-через-примеры)
   5. [Начинайте с zero-shot примера, затем переходите к нескольким примерам (few-shot)](#5-начинайте-с-zero-shot-примера-затем-переходите-к-нескольким-примерам-few-shot)
   6. [Уменьшите "пушистые" и неточные описания](#6-уменьшите-пушистые-и-неточные-описания)
   7. [Говорите, что делать вместо того, что не делать](#7-говорите-что-делать-вместо-того-что-не-делать)
   8. [Используйте "ведущие слова" для генерации кода](#8-используйте-ведущие-слова-для-генерации-кода)
3. [Параметры](#параметры)

## Как работает создание промптов

Из-за способа, которым обучаются модели OpenAI, существуют определённые форматы запросов, которые работают особенно хорошо и приводят к более полезным результатам модели.

[Официальное руководство по созданию промптов от OpenAI](https://platform.openai.com/docs/guides/prompt-engineering) обычно является лучшим местом для начала при поиске советов по созданию промптов.

Ниже мы представляем несколько форматов запросов, которые, по нашему мнению, хорошо работают, но не стесняйтесь исследовать различные форматы, которые могут лучше подходить для вашей задачи.

## Правила и примеры

Примечание: `{text input here}` является заполнителем для фактического текста/контекста

### 1. Используйте последнюю модель

Для лучших результатов мы обычно рекомендуем использовать последние, наиболее мощные модели. Новые модели, как правило, легче настраивать с помощью промптов.

### 2. Поместите инструкции в начале промпта

Используйте `###` или `"""` для разделения инструкции и контекста.

**Менее эффективно ❌:**
```
Суммаризируйте текст ниже в виде списка ключевых пунктов.

{text input here}
```

**Лучше ✅:**
```
Суммаризируйте текст ниже в виде списка ключевых пунктов.

Текст: """
{text input here}
"""
```
### 3. Будьте конкретны

Будьте конкретны, описательны и как можно более детальны в отношении желаемого контекста, результата, длины, формата, стиля и т.д.

**Менее эффективно ❌:**
```
Напишите стихотворение об OpenAI.
```

**Лучше ✅:**
```
Напишите короткое вдохновляющее стихотворение об OpenAI, сосредоточенное на недавнем запуске продукта DALL-E (DALL-E - это модель машинного обучения для преобразования текста в изображение) в стиле {знаменитого поэта}.
```

### 4. Определите желаемый формат вывода через примеры

**Менее эффективно ❌:**
```
Извлеките сущности, упомянутые в тексте ниже. Извлеките следующие 4 типа сущностей: названия компаний, имена людей, конкретные темы и общие темы.

Текст: {text}
```

**Лучше ✅:**
```
Извлеките важные сущности, упомянутые в тексте ниже. Сначала извлеките все названия компаний, затем все имена людей, затем конкретные темы, соответствующие содержанию, и, наконец, общие темы.

Желаемый формат:
Названия компаний: <список названий компаний через запятую>
Имена людей: -||-
Конкретные темы: -||-
Общие темы: -||-

Текст: {text}
```

### 5. Начинайте с zero-shot примера, затем переходите к нескольким примерам (few-shot)

**Zero-shot ✅:**
```
Извлеките ключевые слова из текста ниже.

Текст: {text}

Ключевые слова:
```

**Few-shot ✅:**
```
Извлеките ключевые слова из соответствующих текстов ниже.

Текст 1: Stripe предоставляет API, которые веб-разработчики могут использовать для интеграции обработки платежей в свои веб-сайты и мобильные приложения.
Ключевые слова 1: Stripe, обработка платежей, API, веб-разработчики, веб-сайты, мобильные приложения
##
Текст 2: OpenAI обучила передовые языковые модели, которые очень хорошо понимают и генерируют текст. Наш API предоставляет доступ к этим моделям и может использоваться для решения практически любой задачи, связанной с обработкой языка.
Ключевые слова 2: OpenAI, языковые модели, обработка текста, API.
##
Текст 3: {text}
Ключевые слова 3:
```

**Точная настройка (fine-tune) ✅:** Смотрите лучшие практики файнтюна [здесь](https://platform.openai.com/docs/guides/fine-tuning).

### 6. Уменьшите "пушистые" и неточные описания

**Менее эффективно ❌:**
```
Описание этого продукта должно быть довольно коротким, всего несколько предложений, и не намного больше.
```

**Лучше ✅:**
```
Используйте абзац из 3-5 предложений, чтобы описать этот продукт.
```

### 7. Говорите, что делать вместо того, что не делать

**Менее эффективно ❌:**
```
Следующий диалог между Агентом и Клиентом. НЕ СПРАШИВАЙТЕ ИМЯ ПОЛЬЗОВАТЕЛЯ ИЛИ ПАРОЛЬ. НЕ ПОВТОРЯЙТЕ.

Клиент: Я не могу войти в свой аккаунт.
Агент:
```

**Лучше ✅:**
```
Следующий диалог между Агентом и Клиентом. Агент попытается диагностировать проблему и предложить решение, избегая вопросов, связанных с личной информацией. Вместо того чтобы спрашивать личную информацию, такую как имя пользователя или пароль, направьте пользователя на статью справки www.samplewebsite.com/help/faq.

Клиент: Я не могу войти в свой аккаунт.
Агент:
```

### 8. Используйте "ведущие слова" для генерации кода

**Менее эффективно ❌:**
```
# Напишите простую функцию на Python, которая
# 1. Спрашивает у меня число в милях
# 2. Конвертирует мили в километры
```

В этом примере кода ниже, добавление `import` намекает модели, что она должна начать писать на Python. (Аналогично, `SELECT` является хорошим намёком на начало SQL-запроса.)

**Лучше ✅:**
```
# Напишите простую функцию на Python, которая
# 1. Спрашивает у меня число в милях
# 2. Конвертирует мили в километры

import
```

## Параметры

Обычно мы считаем, что модель и температура являются наиболее часто используемыми параметрами для изменения вывода модели.

- **model** - модели с более высокой производительностью, как правило, дороже и могут иметь большую задержку.
- **temperature** - мера того, как часто модель выдаёт менее вероятный токен. Чем выше температура, тем более случайным (и обычно творческим) будет вывод. Однако это не то же самое, что "правдивость". Для большинства фактических случаев использования, таких как извлечение данных и правдивый Q&A, лучше всего подходит температура 0.
- **max_tokens** (максимальная длина) - не контролирует длину вывода, а является жёстким ограничением на генерацию токенов. В идеале вы не должны часто достигать этого предела, так как ваша модель остановится либо когда сочтёт, что закончила, либо когда достигнет указанной вами последовательности остановки.
- **stop** (последовательности остановки) - набор символов (токенов), которые, будучи сгенерированными, остановят генерацию текста.

---

*Пожелания и замечания можно оставить [здесь](https://github.com/Sansan4ez/sansan4ez.github.io/issues).*